# PyAutoClick - macOS 用マウスクリック自動化ツール

macOS でマウスクリックを自動化する Python スクリプトです。PowerShell スクリプトの macOS 版として開発されました。

## 機能

- 指定された座標への自動マウスクリック
- ランダムな座標でのクリック（画面右端付近）
- 60 秒間隔での自動実行
- アクセシビリティ権限の自動チェック
- フェイルセーフ機能（マウスを画面左上角に移動すると停止）

## 前提条件

- macOS
- Python 3.x
- アクセシビリティ権限（システム環境設定で設定が必要）

## セットアップ

### 1. リポジトリのクローン

```bash
git clone <repository-url>
cd py_auto_click
```

### 2. 自動セットアップ

```bash
./run_auto_click.sh
```

初回実行時は自動的に以下が実行されます：

- 仮想環境の作成
- 必要なパッケージのインストール
- スクリプトの実行

### 3. 手動セットアップ（必要に応じて）

```bash
# セットアップスクリプトを実行
./setup.sh

# 実行
./run_auto_click.sh
```

## 使用方法

### 基本的な実行

```bash
./run_auto_click.sh
```

### 停止方法

- `Ctrl+C` を押す
- マウスカーソルを画面の左上角に移動（フェイルセーフ）

## アクセシビリティ権限の設定

スクリプトを実行する前に、以下の手順でアクセシビリティ権限を有効にする必要があります：

1. **システム環境設定** → **セキュリティとプライバシー**
2. **プライバシー** → **アクセシビリティ**
3. **ターミナル**（または**Python**）にチェックを入れる

権限が設定されていない場合、スクリプトは自動的に権限設定の手順を表示します。

## 設定

### クリック座標の変更

`auto_click.py`の以下の部分を編集して、クリック座標を変更できます：

```python
# ランダムな座標を生成（画面サイズ内に調整）
screen_width, screen_height = pyautogui.size()
x = random.randint(screen_width - 100, screen_width - 50)  # 画面右端付近
y = random.randint(400, 500)  # 画面中央付近
```

### 待機時間の変更

```python
# 60秒待機
time.sleep(60)  # この値を変更
```

## ファイル構成

```
py_auto_click/
├── auto_click.py          # メインスクリプト
├── run_auto_click.sh      # 実行スクリプト（自動セットアップ付き）
├── setup.sh              # セットアップスクリプト
├── kill_auto_click.sh     # プロセス終了スクリプト
├── requirements.txt       # Python依存関係
├── .gitignore            # Git除外設定
└── README.md             # このファイル
```

## 依存関係

- `PyAutoGUI` - マウス操作ライブラリ
- `pyobjc-core` - macOS 用 Python-Objective-C ブリッジ
- `pyobjc-framework-Cocoa` - Cocoa フレームワーク
- `pyobjc-framework-Quartz` - Quartz フレームワーク

## トラブルシューティング

### アクセシビリティ権限エラー

```
❌ アクセシビリティ権限エラー: ...
```

**解決方法**: システム環境設定でアクセシビリティ権限を有効にしてください。

### モジュールが見つからないエラー

```
ModuleNotFoundError: No module named 'pyautogui'
```

**解決方法**: `./run_auto_click.sh`を実行してください。自動的に仮想環境とパッケージがセットアップされます。

### フェイルセーフが発動する

```
フェイルセーフが発動しました。プログラムを終了します...
```

**解決方法**: マウスカーソルを画面の左上角から離してください。

## 注意事項

- このスクリプトは自動化目的で使用してください
- 実行中はマウスカーソルを画面左上角に移動しないでください（フェイルセーフが発動します）
- アクセシビリティ権限が必要なため、初回実行時は手動で権限を設定する必要があります
- スクリプトの実行中は他のアプリケーションの操作に注意してください

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。詳細は[LICENSE](LICENSE)ファイルを参照してください。

## 更新履歴

- v1.0.0 - 初回リリース
  - 基本的なマウスクリック自動化機能
  - 自動セットアップ機能
  - アクセシビリティ権限チェック
